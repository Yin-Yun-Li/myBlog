<script>
  (function() {
    const savedTheme = localStorage.getItem("quarto-color-scheme");
    const systemDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    const isDark = savedTheme === "dark" || (!savedTheme && systemDark);

    // 立即漆上底色，這是防閃白最快的一步
    document.documentElement.style.backgroundColor = isDark ? "#1a1a1a" : "#ffffff";
    
    // 如果是深色模式，立即為 html 加上類別，防止 CSS 載入延遲
    if (isDark) {
      document.documentElement.classList.add('quarto-dark');
    } else {
      document.documentElement.classList.add('quarto-light');
    }
  })();
</script>